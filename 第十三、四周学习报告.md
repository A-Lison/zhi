## JS高阶-JSON+AJAX

### JSON

前后端分离，JSON就是王者！！！

区分：json不是对象，只是对象的信息，本质是一个字符串

##### json与对象互转

json转成对象，用JSON.parse()方法：

```
 var str = JSON.parse(user);
```

对象转成json，用JSON.stringify()方法：

```
  var user = {
            name: "哈利波特",
            age: 18,
            sex: "男"
        }
    console.log(JSON.stringify(user, null, ''));输出全部的值
	console.log(JSON.stringify(user, ["name", "age"], '')); //输出指定的值
	
	var obj = JSON.stringify(str);
```

toJSON()

```
toJSON: function () {
        return { // 只输出name和age，并且改变了key：
            'Name': this.name,
            'Age': this.age
        };
        
```

### AJAX

##### 使用JQeury

![image-20210529211326601](C:/Users/555/AppData/Roaming/Typora/typora-user-images/image-20210529211326601.png)

基本使用

```
 $('button').on('click', function() {
        $.ajax({
            //请求方式 post/get
            type: 'post',
            //请求地址
            url: 'https://im.qq.com/',
            //发送请求数据
            data: {
                name: 'zahngsan',
                age: '222'
            },
            //response为服务器端返回的数据
            success: function(response) {
                //方法内部会自动将json字符串转换为json对象
                console.log(response);
            }
        })
    });
```

###### 传送json格式

```
//指定参数格式类型为json
contentType:'application/json'


JSON.stringify({name:'zahngsan',age:'20'})
```

###### serialize()

将表单数据拼接成字符串类型，数据之间用&链接

###### 用jquery的ajax来请求jsonp

```
 $.ajax({
    		url:'//www.bejson.com/test/userinfop.php',
     		type:"GET",
     		//代表发送jsonp请求
            dataType:"jsonp",
            jsonp: false, 
            jsonpCallback: "showjson", //这里的值需要和回调函数名一样
            success:function(data){
                console.log("Script loaded and executed.");
            },
            error:function (textStatus) { //请求失败后调用的函数
                console.log(JSON.stringify(textStatus));
            }
}); 
```

###### 全局事件

```
.ajaxStart()//当请求开始时触发
.ajaxComplete()//当请求完成时触发


$(document).on('ajaxStart',function·(){
console.log('start')
})
$(document).on('ajaxComplete',function·(){
console.log('Complete')
})

```

###### 页面事件触发插件（藏）

NProgress.js()

## JQuery

##### 基本使用

```
 $('div').hide();

    // //等着页面DOM加载完再去执行JS代码的两种写法
    // $(document).ready(function() {
    //     $('div').hide();
    // })

    // $(function() {
    //     $('div').hide();

    // })
```

##### 对象

```
 <script>
 //区别
        var myDiv=document.querySelector('div');//DOM获取对象 
        $('div');//JQuery获取对象
        console.dir($('div'));
        //JQuery对象只能使用JQuery方法，DOM对象只能使用DOM对象原生的js属性和方法
    </script>
    
  //转换
  		//JQuery对象转为DOM对象
   		$(myDiv);
        //DOM对象转为JQuery对象
        $('span')[0];
        $('span').get(0);
```

##### 选择器

###### 设置样式

```
$('span').css("background","pink");
```

###### 筛选

```
 $('ul li:first').css("color", "pink");
            $('ul li:last').css("color", "pink");
            $('ul li:eq(1)').css("color", "pink");
            $('ul li:odd').css("color", "pink");
            $('ul li:even').css("color", "pink");
// 隐式迭代 改变颜色 其余不变色
                $(this).css("background-color", "pink");
                $(this).siblings("button").css("background-color", "");
                //链式编程
                $(this).css("background-color","pink").siblings("button").css("background-color", "");
```

###### 修改样式

操作css

![image-20210528142159286](C:/Users/555/AppData/Roaming/Typora/typora-user-images/image-20210528142159286.png)

操作类

```
$(function() {
            //添加类
            $("div").click(function() {
                $(this).addClass("current");
            });

            //删除类
            $("div").click(function() {
                $(this).removeClass("current");
            });

            //切换类(在添加与删除之间切换)
            $("div").click(function() {
                $(this).toggleClass("current");
            })
        })
```

###### 效果

![image-20210528151748844](C:/Users/555/AppData/Roaming/Typora/typora-user-images/image-20210528151748844.png)

